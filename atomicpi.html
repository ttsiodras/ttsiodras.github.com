<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="canonical" href="https://www.thanassis.space/atomicpi.html">
<meta name="author" content="Thanassis Tsiodras">
<meta name="author" content="Athanasios Tsiodras">
<meta name="author" content="ttsiod">
<meta name="author" content="ttsiodras">
<link type="text/css" rel="stylesheet" href="final-code-wavetheory-lightbox.css">
<link rel="stylesheet" type="text/css" href="asciinema-player.css">
<link type="application/rss+xml" rel="alternate" href="rss.xml" title="Coding and administration articles by ttsiodras">
<script type="text/javascript" src="prototype.js"></script>
<script type="text/javascript" src="scriptaculous.js?load=effects,builder"></script>
<script type="text/javascript" src="lightbox.js"></script>
<title>Atomic PI</title>
</head>
<body>
    <div class="well" id="Page">
        <div id="Banner">Atomic PI</div>
        <div id="MainContent">
            <a href="//www.reddit.com/r/programming/submit" onclick="window.location = window.location.protocol + '//www.reddit.com/r/programming/submit?url=' + encodeURIComponent(window.location); return false"> <img src="spreddit7.gif" alt="submit to programming reddit" border="0"> </a>
            <br>&nbsp;<br>
            <p><em>(May 2019)</em></p>

<h1>Atomic PI</h1>

<div class="tldr">
<b>For the TL;DR crowd:</b>
<p>
A month ago, while browsing in <a href="https://www.cnx-software.com/">CNX software</a>,
I stumbled on an article about an Intel-based Single Board Computer (SBC);
that apparently cost only 35$. For that price, the specs were beyond impressive - 
they were in the "so cheap, there must be something wrong" category.
<p>
I decided I just *had* to try this out.
<p>
One week later, the "bare-bones" board arrived. And another two weeks later, this little
machine has really <em>pushed my limits</em>.  I've never soldered on Intel HW before;
an Intel machine somehow always created a kind of mental block in my head:
<p>
<em>"This is not a toy! Don't solder/mess with it!..."</em>
<p>
Well, the price of the Atomic PI allowed the rational part of my brain to overcome
the (ridiculous) mental block... And I was able to achieve the results shown below.
<p>
Here it is, in all its splendor, my nerdy brothers and sisters... My new little UNIX server.
</div>

<div style="clear:both; text-align:center; max-width: 90%; margin: 0 auto;">
<a href="front-on-hi.jpg" target="_blank" title="The New Beast (TM) - 4-core Atom, USB 3.0, and my custom power adapter">
<img src="front-on-hi.jpg" alt="The New Beast (TM)"></a><p>
<em>The New Beast (TM) - with my custom power adapter, and a soldered-on (extra) USB connector</em>
</div>

<h2>Before Atomic PI</h2>

<p>I love Single-Board Computers (SBCs).
<p>
I started playing with them 3 years ago, beginning with a Raspberry PI2.
A year later I "graduated" into a setup that was
<a href="thebeast.html#thebeast">a bit more advanced</a>... A 12 Euro
OrangePI board, that I assembled into an always-on file server, and
<a href="https://www.borgbackup.org/">borgbackup</a> server; with an I2C
attached LCD screen, a fan, and various other bells and whistles.</p>

<p>In addition, all of it was done via completely open-sourced SW.
I compiled the <a href="https://www.armbian.com/">ARMBIAN</a> image for my Beast
myself - from sources - so I was fully in control of this tiny UNIX server. </p>

<div style="clear:both; text-align:center; max-width:90%; margin: 0 auto">
<a href="The.Beast.TM.jpg" target="_blank" title="The Old Beast (TM) - 4-core ARM, PI(D)-controlled FAN, I2C 1602, level-shifter...">
<img src="The.Beast.TM.jpg" alt="The Old Beast (TM)"></a><p>
<em>The Old Beast (TM) - 4-core ARM, PI(D)-controlled FAN, I2C 1602, level-shifter...</em>
</div>

<p>I was pretty sure that for my needs, the price/performance ratio I reached 
with the OrangePI was unbeatable. The nearest "competitor", the Raspberry PI3
was <strong>three times as expensive</strong> - and in my experiments, delivered <strong>less than half
I/O-performance</strong> (<em>since in RPIs everything must pass through a single USB root hub</em>).</p>

<h2>"No, that's impossible..."</h2>

<p>But then, a month ago, while browsing in <a href="https://www.cnx-software.com/">CNX software</a>,
I stumbled on an article about an Intel-based Single Board Computer (SBC);
<strong>that apparently cost only 35$</strong>, while being equipped with a 4 core Atom processor,
2GB of RAM, and 16GB of EMMC. And this being an Intel machine, it came with USB3.0;
and also Gigabit Ethernet; and Wi-Fi.</p>

<p>If you keep in touch with the current state of computer HW, your reaction to this is probably like mine:
<p>
<em>What the... That's impossible!<br>
The pieces alone cost a lot more than 35$, never mind putting all this together!</em>
<p>
So yes, I just <em>had</em> to try this out... I took a leap of faith <em>(betting that it's not some fraudulent scheme)</em>,
and ordered this from Amazon. </p>

<p>It arrived to the Netherlands in 5 days.</p>

<p>And I immediately realized that this is not a common SBC... There was no "mainstream" way to power it on.
It needed 5V/3A to be fed over an unusual female pin header - and had no 5.5x2.1mm or
5.5x2.5mm jack, or any kind of a USB power one.</p>

<p>Hmm...</p>

<h2>I like challenges.</h2>

<p>I already had an Excelway configurable-voltage power supply that could provide
the required amps at 5V; so I ordered a female 5.5x2.5mm jack that I could use to drive
the power to the Atomic PI.</p>

<p>But while waiting for this to arrive, I just <em>had</em> to see if the board worked.</p>

<p>So I took my Arduino board - which had such a jack (one that the Excelway's
power plug fit in) and soldered two wires on the power pins - driving the output directly
to the Atomic PI's pin 3 (5V) and pin 6 (GND).</p>

<div class="video-container">
<iframe width="560" height="315" src="https://www.youtube.com/embed/JSh3ww7J6-4?rel=0" frame border="0" allowfullscreen>
</iframe>
</div>

<div style="text-align: center">
  <em>First step: "stealing" power from an Arduino</em>
</div>

<p>It worked!</p>

<p>I booted the machine, found that it had a Debian-based distro pre-installed in the EMMC,
and enjoyed compiling and running my <a href="renderer.html">CPU-based renderer</a>.
I was not disappointed - the Atom was at least
3 times faster than my Orange PI Zero; and more importantly, the huge heatsink kept it cool
while staying dead-silent! With all 4 cores 100% busy rendering a statue, temperature
rose to about 50C - a far, far better result than my Orange PI zero <em>(more than 60C,
downthrottling,... I had to attach a fan and write my own PI(D) controller to keep
it cool)</em>. No such worries with the Atomic PI.</p>

<p>What about mainstream stuff?</p>

<p>I launched Firefox, went to Youtube and watched in full screen a 4K 60fps video.
It worked like a charm - with no hiccups of any kind. And this being an Intel GPU,
I have nothing to worry about regarding the GPU drivers maintenance... The curse of most ARM-based SBCs
in terms of video support is that you are probably stuck at an ancient kernel
<em>(because the makers of most SBCs just bundle Android kernels of e.g. series 3.x)</em>.
You can, in theory, compile a kernel from the mainline - but you usually end up
with a barely functioning framebuffer-based, non-accelerated X11 experience.</p>

<p>What about storage?</p>

<p>Well, a simple <code>dd</code> test on the Atomic PI showed that the EMMC <em>(read sequentially)</em> was delivering data
at 170MBytes/sec. Another <em>huge</em> speed difference, compared to any SD card inside a Raspberry
or an Orange PI... And that SD card, mind you, you'd have to buy extra yourself - whereas the EMMC
in the Atomic PI is already there, covered in the 35$ you paid to get the board.</p>

<h2>Power measurements</h2>

<p>The 5.5x2.5mm adapter arrived a few days later. I quickly desoldered the wires from 
my Arduino board, and put my adjustable buck PSU in the loop - so I could measure power:</p>

<div style="clear:both; text-align:center; margin: 0 auto; max-width: 90%">
<a href="atomic_pi_PSU.jpg" rel="lightbox" title="Idle power measurements on Atomic PI: 5V x 0.7A = 3.5W">
<img src="atomic_pi_PSU.jpg" alt="Power measurements on Atomic PI"></a><p>
<em>Idle power measurements on Atomic PI: 5V x 0.7A = 3.5W</em>
</div>

<ul>
<li>During boot, the Atomic PI peaked up to 1A (so, 5W)</li>
<li>After that, it stabilized to about 700mA (see picture above - 3.5W).</li>
<li>Running my renderer, and occupying all 4 cores at 100%, current jumped to 1.25A (6.25W)</li>
<li>Watching a 4K 60fps video from Youtube in Firefox full screen, ate 0.95A (~5W)</li>
<li>Doing a "dd" from a LUKS-encrypted partition (so, both reading from the USB drive and decoding the data) used 34% of one of the 4 cores, and the current was at about 1A.</li>
</ul>

<p>Those were, admittedly, higher power numbers than those of my two ARM-based SBCs - but not <em>insanely</em> so.
Moreover, when I installed a spartan version of Debian Stretch <em>(with nothing X related,
and a minimal amount of services that I need for my file/backup needs)</em>,
I found that the idle power went even lower, to 2.5W (0.5A). I am guessing that when
the HDMI port is not connected, some parts of the design power off.</p>

<h2>Old-school: the serial port</h2>

<p>Even though it's nice to have accelerated X11 and video decoding, the purpose
I had in mind for my Atomic PI was replacing my old OrangePI-based server with
this much more powerful, headless machine. This would allow me to do things
like offline ffmpeg-based video transcoding - taking advantage of the huge 
optimizations done over the years with Intel-specific hand-written assembly routines.</p>

<p>That, in turn, meant no monitor attached to the Atomic PI's HDMI port. And even though
I planned to use the machine over SSH with a static IP address, I still wanted to have
a fallback of a serial port - just as I had for my ARM SBCs.</p>

<p>Connector CN10 of the board offered the required 3 pins: TX, RX and GND. After connecting
them to a PL2303HX USB/TTL, I was able to see my machine boot up over <code>minicom</code>...</p>

<div class="video-container">
<iframe width="560" height="315" src="https://www.youtube.com/embed/8paRaO61OpY?rel=0" frame border="0" allowfullscreen>
</iframe>
</div>

<div style="text-align: center">
  <em>Monitoring a boot over a serial port</em>
</div>

<p>...and in fact, <strong>I could enter the BIOS and change settings over this serial connection!</strong></p>

<p>That was a surprise!... I never expected to be able to do this on a PC.</p>

<p>It means that I can use a 2-Euro ESP8266 board to "remote-serial" this machine;
connect to the ESP8266 over WiFi, and via its serial port, access the Atomic PI
and change BIOS settings, install different distros (or OpenBSD), etc -
<strong>without being physically present next to it</strong>.</p>

<p>Awesome.</p>

<div style="background: #DD8080; padding: 1em">
<b>UPDATE</b>: A Redditor asked me for more details about this last part;
the steps are relatively simple:

<ul>
<li>the GND/TX/RX pins of the ESP8266 must be connected to the GND/RX/TX pins of the SBC
<li>the ESP8266 itself must be programmed with <a href="https://github.com/esp8266/Arduino/blob/master/libraries/ESP8266WiFi/examples/WiFiTelnetToSerial/WiFiTelnetToSerial.ino">this</a>.
<li>After powering it up, the ESP will connect to the WiFi; and you can then connect to it with a script like this:
</ul>


<div class='codegenWrapper'>
<pre><tt><span class="normal">$ cat remoteMonitor</span><span class="symbol">.</span><span class="normal">sh</span>

<span class="normal">stty -icanon -echo</span>
<span class="normal">stty intr undef</span>
<span class="normal">nc </span><span class="symbol">&lt;</span><span class="normal">IP_ADDR_OF_ESP8266</span><span class="symbol">&gt;</span><span class="normal"> </span><span class="number">23</span>
<span class="normal">stty intr </span>
<span class="normal">stty icanon echo</span>
</tt></pre>
</div>

<p>That's all. Whatever happens on the SBC's serial port will then be shown in your terminal.
On the Atomic PI in particular, it will allow you to enter and modify your BIOS settings.</p>

<p>If you are wondering about the <code>stty</code> commands, they allow sending control characters - e.g. Ctrl-C is sent across to the remote, not to the local nc. This means you can use the connection to perform logins, etc. And when you want to disconnect, just <code>killall nc</code> <em>(assuming this is your only use of <code>netcat</code>:-)&nbsp;</em></p>

<p>The end result, including <a href="remotepower.html">remote-controlled poweron/poweroff functionality</a>:</p>

<div class="video-container">
<iframe width="560" height="315" src="https://www.youtube.com/embed/kPj1apA3Yo0?rel=0" frame border="0" allowfullscreen>
</iframe>
</div>

<div style="text-align: center">
  <em>Remote serial port</em>
</div>

<p></div></p>

<h2>Final solution to power - and an extra USB port.</h2>

<p>But the female 5.5x2.5mm jack still annoyed me. It was a brittle setup;
I didn't like it. I wanted a better, more sturdy solution.</p>

<p>So I ordered a few ingredients for a much better "soup": an adapter I
made that uses male pin headers to give life to the Atomic PI, getting power
from a normal 5.5x2.5mm plug. It also has a switch and a power LED.</p>

<div style="clear:both; text-align:center; margin: 0 auto; max-width: 90%">
<a href="top-side-of-adapter-hi.jpg" rel="lightbox" title="Adapter from 5.5x2.5mm jack, with switch and LED">
<img src="top-side-of-adapter-hi.jpg" alt="Adapter from 5.5x2.5mm jack, with switch and LED"></a><p>
<em>Adapter from 5.5x2.5mm jack, with switch and LED</em>
</div>

<div style="clear:both; text-align:center; margin: 0 auto; max-width: 90%">
<a href="bottom-side-of-adapter-hi.jpg" rel="lightbox" title="Bottom-side of adapter">
<img src="bottom-side-of-adapter-hi.jpg" alt="Bottom-side of adapter"></a><p>
<em>Bottom-side of adapter</em>
</div>

<p>Surprisingly, no magic smoke came out of all these hacks... So I did one final
augmentation: I soldered a female USB breakout on the "webcam" connector,
since I saw in the schematics that this was in fact a USB 2.0 port:</p>

<div style="clear:both; text-align:center; margin: 0 auto; max-width: 90%">
<a href="front-off-hi.jpg" rel="lightbox" title="Final form - before turning it on. My power adapter plugs in the female header.">
<img src="front-off-hi.jpg" alt="Final form - before turning it on. My power adapter plugs in the female header."></a><p>
<em>Final form - before turning it on. My power adapter plugs in the female pin header of the PI.</em>
</div>

<div style="clear:both; text-align:center; margin: 0 auto; max-width: 90%">
<a href="front-on-hi.jpg" rel="lightbox" title="Final form - switched on. The cable in the back is the serial cable.">
<img src="front-on-hi.jpg" alt="Final form - switched on. The cable in the back is the serial cable."></a><p>
<em>Final form - switched on. The cable in the back is the serial cable.</em>
</div>

<p>To stabilize, electrically-isolate and provide some strength to the soldered USB port wires, I hot-glued them into place.</p>

<p>In fact, that's the thing I am most grateful to Digital Loggers for;
by selling such a cheap Intel-based machine, they allowed me to
break through the "mental block" associated with any Intel HW:</p>

<p><em>"It's not a toy, don't solder/mess with it!"</em></p>

<p>Well, I've now soldered stuff on Intel-equipped motherboards.<br>
Guess I've crossed another threshold :-)</p>

<h2>Conclusion</h2>

<p>I've shared some of the material above on the Atomic PI subreddit ; but I've decided
that it's far better to write it all down in my blog as well. At the very least
this may help people - by addressing some of their questions, and also showing
them what is possible with the Atomic PI.</p>

<p>Overall, this is a fantastic little machine - and probably the best bargain I've ever
seen, anywhere, in terms of computing power. No other SBC comes close to this
price/performance ratio - if you don't believe me, Google for 
the prices of Intel motherboards equipped with the same processor, then add 2GB of RAM,
and 16GB of EMMC - and compare the result to 35$.</p>

<p>As for how this incredible price was achieved, some rumours indicate the boards
came out from a failed robotics company. In my mind, that makes it even better:
I have here in front of me, the heart of a robot. And though it's a bit sad that 
it didn't amount to what it was meant to... well, at least it will serve me - and 
it will serve me well.</p>

<p>My new Beast smiles at me from across the room, with his green LED indicating that life is good.</p>

<p>I love it :-)</p>

<h2>Update - a month later</h2>

<p>I added <a href="remotepower.html">remote-controlled poweron/poweroff and remote serial port functionality</a>, via an ESP8266.
<br>Below you will see a couple of videos demonstrating both features - for details,
check out the linked blog post.</p>

<div>
<div class="video-container">
<iframe width="560" height="315" src="https://www.youtube.com/embed/6m-Zd31SrOE?rel=0" frame border="0" allowfullscreen>
</iframe>
</div>

<div style="text-align: center">
  <em>My custom-programmed ESP-01 controls a relay,<br>
and allows me to remotely poweron/poweroff my AtomicPI</em>
</div>

<p>&nbsp;<br></p>

<div class="video-container">
<iframe width="720" height="720" src="https://www.youtube.com/embed/kPj1apA3Yo0?rel=0" frame border="0" allowfullscreen>
</iframe>
</div>

<div style="text-align: center">
  <em>It also allows me to connect remotely to the Atomic PI's serial port.</em>
</div>

<h2>Final update - 19 months later</h2>

<p>I built a <a href="atomicpi-usb2.html">USB2 adapter board, and then designed and 3D-printed an enclosure</a>.</p>

<div style="clear:both; text-align:center; margin: 0 auto; max-width: 90%">
<a href="atomicpi-TLDR.webp" target="_blank" title="Final form.">
<img src="atomicpi-TLDR.webp" alt="Final form."></a><p>
</div>

<p><p>&nbsp;<br>
<a href="https://www.reddit.com/r/Atomic_Pi/comments/bvevev/everything_ive_done_on_my_atomic_pi_including_a/">Discuss on Reddit</a></p>

<br>
    <hr>
    <div style='margin-top:1em'>
        <div style='float:left'>
            <a target="_blank" href="https://stackoverflow.com/users/382050/ttsiodras">
                <img src="382050.png" width="208" height="58" alt="profile for ttsiodras at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for ttsiodras at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
            </a>
        </div>
        <div style='float:left; margin-left:1em'>
            <a target="_blank" href="https://github.com/ttsiodras">
                <img border="1" src="github.png" alt='GitHub member ttsiodras' title='GitHub member ttsiodras'>
            </a>
        </div>
        <!--div style='float:left; margin-left:1em'>
            <a target="_blank" href="https://projecteuler.net/profile/ttsiodras.png">
                <img src="https://projecteuler.net/profile/ttsiodras.png" alt='Project Euler member ttsiodras' title='Project Euler member ttsiodras'>
            </a>
        </div-->
    </div>
    <div style='clear:both; margin-bottom:0.5em'></div>

<!-- Used to do this with float:right, but Opera Mini shows nothing with it... back to tables :-( -->
<table summary="Footer" width="100%" border="0"><tr><td><a href="index.html">Back to index</a>&nbsp;&nbsp;<a href="cv.pdf">My CV</a></td><td align="right"><em>Last update on: Sat Apr 17 21:45:15 2021</em></td></tr></table>

            <hr style="margin-bottom: 1em">
            <p id="disqus_thread">
                The comments on this website require the use of JavaScript. Perhaps your browser isn't
                JavaScript capable or the script is not being run for another reason. If you're
                interested in reading the comments or leaving a comment behind please try again with a
                different browser or from a different connection.
            </p>
            <script type="text/javascript">
                /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                var disqus_shortname = 'ttsiodras';
                var disqus_identifier = '../content/atomicpi.content';

                (function() {
                    'use strict';

                    /**
                     * This method will handle the click on the button to load the comments. It will remove the
                     * button and execute the original Disqus script for loading the comments.
                     */
                    function button_clickHandler(event) {
                        // We need to get the button element, we could also use the target property of the event
                        // but this will do just as well
                        var button = document.getElementById('disqus_thread');
                        // Now we will have to recreate the div element we removed from the HTML. We will place
                        // it into the DOM like we did when we created the button
                        var disqusContainer = document.createElement('div');
                        button.parentNode.insertBefore(disqusContainer, button);
                        button.parentNode.removeChild(button);

                        // The div element will need to have the disqus_thread id as this is required for Disqus,
                        // it is the way their code identifies the element in which the comments can be displayed
                        disqusContainer.id = 'disqus_thread';

                        // Now we can execute the original Disqus code
                        var dsq = document.createElement('script');
                        dsq.type = 'text/javascript';
                        dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    }

                    /**
                     * This method will initialize the module. It will replace the JavaScript dependency message
                     * with a button which will allow the visitor to load the comments.
                     */
                    function init() {
                        // Try to get the element we used to display the message about the JavaScript dependency
                        var placeholder = document.getElementById('disqus_thread');
                        // If we didn't get the placeholder element we will stop setting up the button to load
                        // the comments
                        if (placeholder == null) {
                            return;
                        }

                        // The placeholder was found, now we can create the button which will allow the visitor to
                        // load the comments
                        var button = document.createElement('button');
                        button.appendChild(document.createTextNode('Click here to see the comments (powered by Disqus)'));
                        button.addEventListener('click', button_clickHandler.bind(this));

                        // We will insert the button before the placeholder and once the button has been placed in
                        // the DOM we will remove the placeholder
                        placeholder.parentNode.insertBefore(button, placeholder);
                        placeholder.parentNode.removeChild(placeholder);

                        // The placeholder used to have the id which can be reference by an anchor element, to make
                        // sure we don't break this functionality we will apply the id to our newly created button
                        button.id = 'disqus_thread';
                    }

                    // Setup the module
                    init();
                })();
            </script>
        </div>
    </div>
</body>
</html>
